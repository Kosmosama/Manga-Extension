<div class="manga-card" role="listitem" [attr.tabindex]="tabIndexValue()" (cardAction)="onCardAction($any($event))"
    [class.focused]="focused()" aria-label="{{ manga().title }}">
    <div class="cover-wrapper">
        @if (imageLoading()) {
        <div class="image-skeleton" aria-hidden="true"></div>
        }
        <img [src]="isImageValid() ? manga().image : fallbackImage()"
            [attr.alt]="isImageValid() ? manga().title : ('accessibility.image.altFallback' | transloco)"
            (error)="imageNotFound()" (load)="imageLoaded()" loading="lazy" class="manga-cover"
            [class.hidden]="imageLoading()" />
    </div>

    <div class="manga-info">
        <h2 class="title">{{ manga().title }}</h2>
        <p>{{ 'manga.card.chapters' | transloco }}: {{ manga().chapters }}</p>
        <p>{{ 'manga.card.updated' | transloco }}: {{ manga().updatedAt }}</p>

        @if (manga().resolvedTags?.length) {
        <div class="tag-badges">
            @for (tag of manga().resolvedTags; track tag.id) {
            <span class="tag-badge" [style.background]="tag.color">{{ tag.name }}</span>
            }
        </div>
        }

        <div class="actions" aria-label="{{ 'accessibility.mangaCard.favoriteToggle' | transloco }}">
            <button (click)="updateChapters(-1)" [disabled]="saving() || manga().chapters <= 0"
                aria-label="{{ 'accessibility.mangaCard.decrementChapters' | transloco }}">-</button>
            <button (click)="updateChapters(1)" [disabled]="saving()"
                aria-label="{{ 'accessibility.mangaCard.incrementChapters' | transloco }}">+</button>
            <button (click)="toggleFavorite()" [class.favorited]="manga().isFavorite"
                [attr.aria-label]="manga().isFavorite ? ('actions.unfavorite' | transloco) : ('actions.favorite' | transloco)">
                {{ manga().isFavorite ? 'â˜…' : 'â˜†' }}
            </button>
            <button (click)="deleteManga()" aria-label="{{ 'accessibility.mangaCard.delete' | transloco }}">ğŸ—‘ï¸</button>
        </div>

        <button (click)="editManga()" class="edit-btn" aria-label="{{ 'accessibility.mangaCard.edit' | transloco }}">
            {{ 'common.edit' | transloco }}
        </button>
    </div>
</div>