<div class="page-wrapper">
    <div class="toolbar">
        <div class="search-group">
            <input type="search" [value]="searchQuery()"
                (input)="onSearchInput($any($event.target)?.value)"
                placeholder="{{ 'search.placeholder' | transloco }}" class="search-input" />
            @if (searchQuery()) {
            <button (click)="clearSearch()" aria-label="{{ 'search.clear' | transloco }}">âœ•</button>
            }
        </div>
        <button (click)="toggleSort()" class="sort-btn">
            {{ 'manga.sort.label' | transloco }}:
            <strong>{{ sortOrder() === 'asc' ? ('manga.sort.asc' | transloco) : ('manga.sort.desc' | transloco)
                }}</strong>
        </button>
        <button (click)="openForm()" class="add-btn">
            {{ 'actions.add' | transloco }}
        </button>
    </div>

    <tag-filter-bar />

    @if (mangaList().length === 0) {
    <p class="empty-state">{{ 'manga.empty' | transloco }}</p>
    } @else {
    <div class="manga-grid">
        @for (m of mangaList(); track m.id) {
        <manga-card [manga]="m" [handleEdit]="handleEdit" (deleted)="handleMangaDeletion($event)" />
        }
    </div>
    }

    <modal #modal>
        <h3>{{ selectedManga() ? ('actions.edit' | transloco) : ('actions.add' | transloco) }}</h3>
        <manga-form [manga]="selectedManga()" (formSumbitted)="handleFormSumbission($event); modal.close()" />
    </modal>

    <modal #editModal>
        <h3>{{ 'actions.edit' | transloco }}</h3>
        <manga-form [manga]="selectedManga()" (formSumbitted)="handleFormSumbission($event); editModal.close()" />
    </modal>
</div>